'use strict';function _0x408e(_0xc1b991,_0x5d9b2a){var _0xbaf5c9=_0xbaf5();return _0x408e=function(_0x408ec6,_0x41b14f){_0x408ec6=_0x408ec6-0x1a6;var _0x2fd893=_0xbaf5c9[_0x408ec6];return _0x2fd893;},_0x408e(_0xc1b991,_0x5d9b2a);}var _0x173746=_0x408e;(function(_0x449f1f,_0x47f40a){var _0x56262a=_0x408e,_0x146092=_0x449f1f();while(!![]){try{var _0x5a36d2=parseInt(_0x56262a(0x1bb))/0x1*(-parseInt(_0x56262a(0x1b4))/0x2)+parseInt(_0x56262a(0x1c3))/0x3+parseInt(_0x56262a(0x1c5))/0x4+parseInt(_0x56262a(0x1b6))/0x5+parseInt(_0x56262a(0x1be))/0x6*(-parseInt(_0x56262a(0x1ad))/0x7)+parseInt(_0x56262a(0x1d7))/0x8*(parseInt(_0x56262a(0x1d3))/0x9)+-parseInt(_0x56262a(0x1b1))/0xa;if(_0x5a36d2===_0x47f40a)break;else _0x146092['push'](_0x146092['shift']());}catch(_0x44657c){_0x146092['push'](_0x146092['shift']());}}}(_0xbaf5,0x8a7fd));var _jsonwebtoken=_interopRequireDefault(require(_0x173746(0x1d4))),_lodash=require(_0x173746(0x1ca)),_uuid=require(_0x173746(0x1d2)),_index=_interopRequireDefault(require(_0x173746(0x1b8))),_bcryptjs=_interopRequireDefault(require('bcryptjs'));function _interopRequireDefault(_0x1b528d){var _0x5ae37d=_0x173746;return _0x1b528d&&_0x1b528d[_0x5ae37d(0x1a8)]?_0x1b528d:{'default':_0x1b528d};}require(_0x173746(0x1c6))[_0x173746(0x1bf)]();function _0xbaf5(){var _0x4764f3=['__esModule','user','json','headers','/participant/all','7bUkeiK','/register','TokenExpiredError','exports','11111750jRKYla','status','Roles','216902wjklRs','includes','2258785BSQLoF','url','../models/index','default','email','7XjxrBV','some','body','2755356BqkaBL','config','delay','JWT\x20Token\x20đã\x20hết\x20hạn.\x20Bạn\x20cần\x20dùng\x20Refresh_Token\x20để\x20lấy\x20token\x20mới,\x20or\x20Login\x20lại\x20và\x20sử\x20dụng\x20Access_Token\x20mới\x20:v','tOgzb','3277749omEfMI','/participant','2429476xwwLbu','dotenv','length','/refresh-token','groupWithRoles','lodash','nZhXk','axZea','split','access_token','Bearer','authorization','verify','uuid','352962UoElRO','jsonwebtoken','path','cookies','152WAxzad','[Not\x20authenticated\x20the\x20user]\x20JWT\x20Token\x20đã\x20hết\x20hạn,\x20hoặc\x20bạn\x20không\x20truyền\x20lên\x20Bearer\x20Token\x20ở\x20header\x20request.\x20Vui\x20lòng\x20login,\x20hoặc\x20kiểm\x20tra\x20header\x20request\x20đã\x20truyền\x20JWT\x20chưa\x20?','/account'];_0xbaf5=function(){return _0x4764f3;};return _0xbaf5();}var nonSecurePaths=['/logout','/login',_0x173746(0x1ae),_0x173746(0x1c8),_0x173746(0x1c4),_0x173746(0x1ac)],verifyToken=function(_0x1ecadb){var _0x27b691=_0x173746,_0x3db229=process['env']['JWT_SECRET'],_0x4a7893=null;try{_0x4a7893=_jsonwebtoken[_0x27b691(0x1b9)][_0x27b691(0x1d1)](_0x1ecadb,_0x3db229);}catch(_0x4958c5){if(_0x27b691(0x1cc)!==_0x27b691(0x1cc))_0x12f2b0();else{if(_0x4958c5 instanceof _jsonwebtoken['default'][_0x27b691(0x1af)])return _0x27b691(0x1af);}}return _0x4a7893;},extractToken=function(_0x3ca760){var _0x54cdff=_0x173746;return _0x3ca760['headers'][_0x54cdff(0x1d0)]&&_0x54cdff(0x1cf)===_0x3ca760[_0x54cdff(0x1ab)][_0x54cdff(0x1d0)][_0x54cdff(0x1cd)]('\x20')[0x0]?_0x3ca760[_0x54cdff(0x1ab)][_0x54cdff(0x1d0)][_0x54cdff(0x1cd)]('\x20')[0x1]:null;},checkUserJWT=function(_0x5f07a5,_0xd489d7,_0x5db458){var _0x56aaa1=_0x173746;if(nonSecurePaths[_0x56aaa1(0x1b5)](_0x5f07a5[_0x56aaa1(0x1d5)]))return _0x5db458();var _0x3dc7e0=_0x5f07a5[_0x56aaa1(0x1d6)],_0x3e076f=extractToken(_0x5f07a5);return _0x3dc7e0&&_0x3dc7e0[_0x56aaa1(0x1ce)]||_0x3e076f?(_0x3dc7e0=_0x3dc7e0&&_0x3dc7e0[_0x56aaa1(0x1ce)]?_0x3dc7e0['access_token']:_0x3e076f,(_0x3e076f=verifyToken(_0x3dc7e0))&&'TokenExpiredError'!==_0x3e076f?(_0x5f07a5[_0x56aaa1(0x1a9)]=_0x3e076f,void _0x5db458()):_0x3e076f&&_0x56aaa1(0x1af)===_0x3e076f?_0xd489d7[_0x56aaa1(0x1b2)](0x195)[_0x56aaa1(0x1aa)]({'EC':-0x3e7,'DT':'','EM':_0x56aaa1(0x1c1)}):_0xd489d7[_0x56aaa1(0x1b2)](0x191)[_0x56aaa1(0x1aa)]({'EC':-0x1,'DT':'','EM':_0x56aaa1(0x1a6)})):_0xd489d7[_0x56aaa1(0x1b2)](0x191)[_0x56aaa1(0x1aa)]({'EC':-0x1,'DT':'','EM':_0x56aaa1(0x1a6)});},checkUserPermission=function(_0xec3317,_0x239ea0,_0x56d5b5){var _0x2bf374=_0x173746;return nonSecurePaths[_0x2bf374(0x1b5)](_0xec3317[_0x2bf374(0x1d5)])||_0x2bf374(0x1a7)===_0xec3317[_0x2bf374(0x1d5)]?_0x56d5b5():_0xec3317[_0x2bf374(0x1a9)]?(_0xec3317[_0x2bf374(0x1a9)][_0x2bf374(0x1ba)],_0xfb727d=_0xec3317['user'][_0x2bf374(0x1c9)][_0x2bf374(0x1b3)],_0x142640=_0xec3317[_0x2bf374(0x1d5)],!_0xfb727d||0x0===_0xfb727d[_0x2bf374(0x1c7)]||!0x0!==_0xfb727d[_0x2bf374(0x1bc)](function(_0x2918bf){var _0x41636c=_0x2bf374;return _0x41636c(0x1c2)!==_0x41636c(0x1cb)?_0x2918bf[_0x41636c(0x1b7)]===_0x142640||_0x142640[_0x41636c(0x1b5)](_0x2918bf['url']):_0x463877[_0x41636c(0x1ab)][_0x41636c(0x1d0)]&&_0x41636c(0x1cf)===_0x3d1b6e[_0x41636c(0x1ab)][_0x41636c(0x1d0)][_0x41636c(0x1cd)]('\x20')[0x0]?_0x13b468[_0x41636c(0x1ab)][_0x41636c(0x1d0)]['split']('\x20')[0x1]:null;})?_0x239ea0[_0x2bf374(0x1b2)](0x193)[_0x2bf374(0x1aa)]({'EC':-0x1,'DT':'','EM':'you\x20don\x27t\x20permission\x20to\x20access\x20this\x20resource...'}):void _0x56d5b5()):_0x239ea0[_0x2bf374(0x1b2)](0x191)[_0x2bf374(0x1aa)]({'EC':-0x1,'DT':'','EM':_0x2bf374(0x1a6)});var _0xfb727d,_0x142640;},addDelay=function(_0x4342a7,_0x5e4672,_0x112f04){var _0x463234=_0x173746,_0x3dbb25;null!=_0x4342a7&&null!=(_0x3dbb25=_0x4342a7['body'])&&_0x3dbb25[_0x463234(0x1c0)]?setTimeout(function(){_0x112f04();},+_0x4342a7[_0x463234(0x1bd)]['delay']):_0x112f04();};module[_0x173746(0x1b0)]={'checkUserJWT':checkUserJWT,'checkUserPermission':checkUserPermission,'addDelay':addDelay};